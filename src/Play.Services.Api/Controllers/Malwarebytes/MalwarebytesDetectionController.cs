namespace Play.Services.Api.Controllers.Malwarebytes;

[Route("malwarebytes/detections")]
public class MalwarebytesDetectionController : ApiController
{
    private readonly IMalwarebytesDetectionService _malwarebytesDetectionService;

    public MalwarebytesDetectionController(IMalwarebytesDetectionService malwarebytesDetectionService)
    {
        _malwarebytesDetectionService = malwarebytesDetectionService;
    }

    [HttpGet("{id}")]
    [Authorize(Roles = "PlayAdmin")]
    public async Task<IActionResult> GetDetectionById(string id)
    {
        var detection = await _malwarebytesDetectionService.GetDetectionsByAccountIdAsync(id);
        return CustomResponse(detection);
    }

    [HttpGet("all")]
    [Authorize(Roles = "PlayAdmin")]
    public async Task<IActionResult> GetAllDetections()
    {
        var detections = await _malwarebytesDetectionService.GetAllDetectionsAsync();
        return CustomResponse(detections);
    }
}