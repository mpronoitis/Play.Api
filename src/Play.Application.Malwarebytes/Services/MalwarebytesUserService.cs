using MalwarebytesOneviewApi.Core;
using MalwarebytesOneviewApi.Models;
using Play.Application.Malwarebytes.Interfaces;

namespace Play.Application.Malwarebytes.Services;

public class MalwarebytesUserService : IMalwarebytesUserService
{
    private readonly MbamOneViewApi _mbam;

    public MalwarebytesUserService(MbamOneViewApi mbam)
    {
        _mbam = mbam;
    }

    /// <summary>
    ///     Get all users from OneView
    /// </summary>
    /// <returns> list of <see cref="MbamOneViewUser" /> </returns>
    public async Task<MbamOneViewUser[]> GetUsersAsync()
    {
        return await _mbam._UserCommands.GetUsersAsync();
    }

    /// <summary>
    ///     Get total number of users
    /// </summary>
    /// <returns> number of users </returns>
    public async Task<int> GetUsersCountAsync()
    {
        var users = await GetUsersAsync();
        return users.Length;
    }
}